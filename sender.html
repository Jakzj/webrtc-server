<!DOCTYPE html>
<html>
<body>
<h2>Live Camera Sender</h2>
<video id="video" autoplay playsinline></video>

<script>
const ws = new WebSocket("WSS_URL_HIER");

ws.onopen = () => {
  ws.send(JSON.stringify({ type: "register", role: "sender" }));
};

let pc = new RTCPeerConnection();

pc.onicecandidate = (e) => {
  if (e.candidate) {
    ws.send(JSON.stringify({ type: "candidate", candidate: e.candidate }));
  }
};

navigator.mediaDevices.getUserMedia({ video: true, audio: false })
  .then(stream => {
    document.getElementById("video").srcObject = stream;
    stream.getTracks().forEach(t => pc.addTrack(t, stream));

    pc.createOffer().then(o => {
      pc.setLocalDescription(o);
      ws.send(JSON.stringify({ type: "offer", offer: o }));
    });
  });

ws.onmessage = (msg) => {
  let data = JSON.parse(msg.data);

  if (data.type === "answer") {
    pc.setRemoteDescription(new RTCSessionDescription(data.answer));
  }

  if (data.type === "candidate") {
    pc.addIceCandidate(new RTCIceCandidate(data.candidate));
  }
};
</script>
</body>
</html>